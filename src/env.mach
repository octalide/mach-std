use std.types.string;

ext "C:getenv" c_getenv: fun(*u8) *u8;

fun env_get(name: string) []u8 {
    val p: *u8 = c_getenv(name);

    if (p == nil) {
        ret []u8{ nil, 0 };
    }

    # compute length
    var n: u64 = 0;
    for {
        if (@(p + n) == 0) { brk; }
        n = n + 1;
    }

    ret []u8{ p, n };
}
